<%= render "tabs" %>

<% if @requests.any? { |request| request.buyer_item.user == current_user } %>
  <h2>Pending Swaps</h2>
  <% @requests.each do |request| %>
    <% if request.buyer_item.user == current_user %>
      <div class="product-card" data-toggle="modal" data-target="#modal-<%= request.id %>">
        <div class="product-details">
          <div class="product-details1">
            <div class="product-p">
              <p>Title: <%= request.buyer_item.book.title %></p>
              <p>Author: <%= request.buyer_item.book.author %></p>
              <p><%= link_to "Delete", request_path(request), method: :delete %></p>
            </div>
            <div>
              <p class="bold">Condition: <%= request.buyer_item.quality %></p>
            </div>
          </div>
          <div class="product-details2">
            <% if request.buyer_item.book.photo.attached? %>
            <%= cl_image_tag(request.buyer_item.book.photo.key, crop: :fill, height: 100, class: "product-img") %>
            <% end %>
          </div>
        </div>
      </div>

      <div class="modal fade" id="modal-<%= request.id %>" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <%= simple_form_for(request) do |f| %>
                <%= f.input :seller_item, collection: @items, label: "Pick form their catalog" %>
                <%= f.input :status, collection: ["pending", "accepted", "declined"], label: "Accept or decline their request" %>
                <div class="d-flex justify-content-between">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  <%= f.submit class: "btn btn-secondary" %>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>

    <% end %>
  <% end %>
<% end %>
